(function(){"use strict";var e={4752:function(e,t,r){var n=r(6210),o=r(8085);function s(e,t,r,n,s,i){const a=(0,o.up)("HelloWorld");return(0,o.wg)(),(0,o.j4)(a,{msg:""})}var i=r(5832);const a=e=>((0,o.dD)("data-v-3e72d802"),e=e(),(0,o.Cn)(),e),c={class:"redirector"},l={class:"welcome-title"},u=a((()=>(0,o._)("h2",{class:"blink"},"收藏此页防止失联",-1))),h={key:0,class:"progress-container"},d={key:1};function f(e,t,r,n,s,a){return(0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("h1",l,(0,i.zw)(s.welcomeTitle),1),u,(0,o._)("button",{onClick:t[0]||(t[0]=(...e)=>a.addToFavorites&&a.addToFavorites(...e)),class:"favorite-button"},"添加到收藏夹"),(0,o._)("h1",null,(0,i.zw)(s.mainMessage),1),s.message?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",h,[(0,o._)("div",{class:"progress-bar",style:(0,i.j5)({width:`${s.progress}%`})},null,4)])),s.message?((0,o.wg)(),(0,o.iD)("h2",d,(0,i.zw)(s.message),1)):(0,o.kq)("",!0)])}var g=r(8493),w={name:"UrlRedirector",data(){return{welcomeTitle:"欢迎访问，正在自动匹配最佳线路访问官网",message:"",mainMessage:"正在为您选择最佳线路",urls:[],progress:0,redirecting:!1,totalResponses:0}},async created(){try{await this.loadConfig(),this.urls.length>0?this.checkUrlsAndRedirect():this.message="没有可用的 URL，请联系管理员"}catch(e){console.error("初始化过程中出错:",e),this.message="初始化失败，请刷新页面重试"}},methods:{addToFavorites(){const e=window.location.href,t=document.title;try{window.external.AddFavorite(e,t)}catch(r){alert("按 Ctrl+D 添加到收藏夹")}},async loadConfig(){try{const e=await g.Z.get("/config.json"),t=e.data;if(this.urls=t.urls||[],this.welcomeTitle=t.welcomeTitle||this.welcomeTitle,!Array.isArray(this.urls)||0===this.urls.length)throw new Error("URL 列表为空或格式不正确")}catch(e){throw console.error("加载配置失败:",e),e}},async checkUrlsAndRedirect(){if(0===this.urls.length)return void(this.message="没有可用的 URL，请联系管理员");const e=this.urls.map((e=>this.checkUrl(e)));try{await Promise.all(e),this.redirecting||(this.message="暂无线路可以访问，请联系管理员")}catch(t){console.error("检查URL时发生错误:",t),this.message="检查URL时发生错误，请刷新页面重试"}},async checkUrl(e){if(this.redirecting)this.updateProgress();else try{const t=Date.now();await g.Z.get(e);const r=Date.now()-t;console.log(`${e} 响应时间: ${r}ms`),this.redirecting=!0;const n=window.location.pathname+window.location.search+window.location.hash;let o=e.endsWith("/")?e.slice(0,-1):e;o+=n,window.location.href=o}catch(t){console.error(`无法访问 ${e}:`,t)}finally{this.updateProgress()}},updateProgress(){this.totalResponses++,this.progress=this.totalResponses/this.urls.length*100}}},p=r(6328);const v=(0,p.Z)(w,[["render",f],["__scopeId","data-v-3e72d802"]]);var m=v,y={name:"App",components:{HelloWorld:m}};const b=(0,p.Z)(y,[["render",s]]);var k=b;(0,n.ri)(k).mount("#app")}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.m=e,function(){var e=[];r.O=function(t,n,o,s){if(!n){var i=1/0;for(u=0;u<e.length;u++){n=e[u][0],o=e[u][1],s=e[u][2];for(var a=!0,c=0;c<n.length;c++)(!1&s||i>=s)&&Object.keys(r.O).every((function(e){return r.O[e](n[c])}))?n.splice(c--,1):(a=!1,s<i&&(i=s));if(a){e.splice(u--,1);var l=o();void 0!==l&&(t=l)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,o,s]}}(),function(){r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,{a:t}),t}}(),function(){r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};r.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,s,i=n[0],a=n[1],c=n[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(o in a)r.o(a,o)&&(r.m[o]=a[o]);if(c)var u=c(r)}for(t&&t(n);l<i.length;l++)s=i[l],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(u)},n=self["webpackChunktiaozhuan"]=self["webpackChunktiaozhuan"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=r.O(void 0,[998],(function(){return r(4752)}));n=r.O(n)})();